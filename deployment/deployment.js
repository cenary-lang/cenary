/**
 * Start testrpc with the following command:
 *
 * testrpc -u 0 -u 1
 *
 * This starts testrpc and unlocks the first two users. Pick one of them's address and set the address below.
 */
var address = "0xc871b86b3f7057499b22d2111c9a72fb19004073";

/**
 * This is the bytecode created by the following Ivy program:
 *
 * int fib(int n) {
 *   int a = 0;
 *   int b = 1;
 *   int sum = 6;
 *   while (n > 1) {
 *     sum = a + b;
 *     a = b;
 *     b = sum;
 *     n = n - 1;
 *   };
 *   return sum;
 * }
 */
var bin = '7f00000000000000000000000000000000000000000000000000000000000007a3807f00000000000000000000000000000000000000000000000000000000000000887f0000000000000000000000000000000000000000000000000000000000000000397f0000000000000000000000000000000000000000000000000000000000000000f30063ec1f79ca60e060020a6000350414157f0000000000000000000000000000000000000000000000000000000000000164577f0000000000000000000000000000000000000000000000000000000000000004357f0000000000000000000000000000000000000000000000000000000000000000527f0000000000000000000000000000000000000000000000000000000000000024357f0000000000000000000000000000000000000000000000000000000000000020527f0000000000000000000000000000000000000000000000000000000000000020517f000000000000000000000000000000000000000000000000000000000000000051017f0000000000000000000000000000000000000000000000000000000000000040527f00000000000000000000000000000000000000000000000000000000000000607f0000000000000000000000000000000000000000000000000000000000000040f35b63ac37eebb60e060020a6000350414157f000000000000000000000000000000000000000000000000000000000000021e577f0000000000000000000000000000000000000000000000000000000000000004357f0000000000000000000000000000000000000000000000000000000000000000527f00000000000000000000000000000000000000000000000000000000000000207f0000000000000000000000000000000000000000000000000000000000000000f35b63c6c2ea1760e060020a6000350414157f00000000000000000000000000000000000000000000000000000000000007a2577f0000000000000000000000000000000000000000000000000000000000000004357f0000000000000000000000000000000000000000000000000000000000000000527f00000000000000000000000000000000000000000000000000000000000000007f0000000000000000000000000000000000000000000000000000000000000020527f00000000000000000000000000000000000000000000000000000000000000017f0000000000000000000000000000000000000000000000000000000000000040527f00000000000000000000000000000000000000000000000000000000000000067f0000000000000000000000000000000000000000000000000000000000000060527f00000000000000000000000000000000000000000000000000000000000000017f0000000000000000000000000000000000000000000000000000000000000080527f0000000000000000000000000000000000000000000000000000000000000080517f000000000000000000000000000000000000000000000000000000000000000051117f00000000000000000000000000000000000000000000000000000000000000a0527f00000000000000000000000000000000000000000000000000000000000000a051157f000000000000000000000000000000000000000000000000000000000000075e575b7f000000000000000000000000000000000000000000000000000000000000044d7f0000000000000000000000000000000000000000000000000000000000000040517f000000000000000000000000000000000000000000000000000000000000002051017f00000000000000000000000000000000000000000000000000000000000000c0527f00000000000000000000000000000000000000000000000000000000000000c0517f0000000000000000000000000000000000000000000000000000000000000060527f0000000000000000000000000000000000000000000000000000000000000040517f0000000000000000000000000000000000000000000000000000000000000020527f0000000000000000000000000000000000000000000000000000000000000060517f0000000000000000000000000000000000000000000000000000000000000040527f00000000000000000000000000000000000000000000000000000000000000017f00000000000000000000000000000000000000000000000000000000000000e0527f00000000000000000000000000000000000000000000000000000000000000e0517f000000000000000000000000000000000000000000000000000000000000000051037f0000000000000000000000000000000000000000000000000000000000000100527f0000000000000000000000000000000000000000000000000000000000000100517f0000000000000000000000000000000000000000000000000000000000000000527f00000000000000000000000000000000000000000000000000000000000000017f0000000000000000000000000000000000000000000000000000000000000120527f0000000000000000000000000000000000000000000000000000000000000120517f000000000000000000000000000000000000000000000000000000000000000051117f0000000000000000000000000000000000000000000000000000000000000140527f00000000000000000000000000000000000000000000000000000000000001405190575b7f00000000000000000000000000000000000000000000000000000000000000807f0000000000000000000000000000000000000000000000000000000000000060f35b';

var abi =
  [
    {
      "name": "identity",
      "type": "function",
      "constant": true,
      "payable": false,
      "inputs": [
        {
          "name": "n",
          "type":"uint256"
        }
      ],
      "outputs": [
        {
          "name": "",
          "type":"uint256"
        }
      ]
    },
    {
      "name": "addvals",
      "type": "function",
      "constant": true,
      "payable": false,
      "inputs": [
        {
          "name": "m",
          "type":"uint256"
        },
        {
          "name": "n",
          "type":"uint256"
        }
      ],
      "outputs": [
        {
          "name": "",
          "type":"uint256"
        }
      ]
    },
    {
      "name": "fib",
      "type": "function",
      "constant": true,
      "payable": false,
      "inputs": [
        {
          "name": "n",
          "type":"uint256"
        }
      ],
      "outputs": [
        {
          "name": "",
          "type":"uint256"
        }
      ]
    }
  ]

var Web3 = require("web3");
var web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
var Contract = new web3.eth.Contract(abi, {data: bin, from: address, gasPrice: 20000000000, gas: 1000000 });
var deployment = Contract.deploy().send();
deployment.then(newContract => {
  console.log(newContract.methods);
  newContract.methods.identity(3).call().then(console.log);
  newContract.methods.addvals(15, 25).call().then(console.log);
  newContract.methods.fib(15).call().then(console.log);
});
